import { AttributeId } from "./Vocabulary.js";

/**
 * Attribute mastery trees (Phase 2): data-driven, validation-backed.
 *
 * Notes:
 * - Nodes are intentionally empty initially; Phase 6 will populate with concrete effects.
 * - Validation guarantees schema integrity + graph sanity before gameplay consumes it.
 */

export const ActivationMode = Object.freeze({
  Always: "Always",
  Hybrid: "Hybrid",
  Attuned: "Attuned",
});

export const ATTRIBUTE_MASTERY_TREES = Object.freeze({
  [AttributeId.Might]: Object.freeze({
    attributeId: AttributeId.Might,
    nodes: Object.freeze([
      {
        id: "might_01_kindling",
        attributeId: AttributeId.Might,
        tier: 1,
        prereqs: [],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Might },
        effects: [{ kind: "todo", action: "enableIgnitePool" }],
      },
      {
        id: "might_02_deepen_ignite",
        attributeId: AttributeId.Might,
        tier: 2,
        prereqs: ["might_01_kindling"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Might },
        effects: [{ kind: "todo", action: "ignitePoolTuning" }],
      },
      {
        id: "might_03_hearth_regen",
        attributeId: AttributeId.Might,
        tier: 3,
        prereqs: ["might_02_deepen_ignite"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Hybrid,
        tags: { attributeTag: AttributeId.Might },
        effects: [{ kind: "todo", action: "hearthStacksRegenLoop" }],
      },
      {
        id: "might_04_press_the_burn",
        attributeId: AttributeId.Might,
        tier: 4,
        prereqs: ["might_03_hearth_regen"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Might },
        effects: [{ kind: "todo", action: "igniteOnHitBurnRateBoost" }],
      },
      {
        id: "might_05a_phoenix_covenant",
        attributeId: AttributeId.Might,
        tier: 5,
        prereqs: ["might_04_press_the_burn"],
        exclusiveGroup: "t5_might",
        activationMode: ActivationMode.Attuned,
        tags: { attributeTag: AttributeId.Might },
        effects: [{ kind: "todo", action: "phoenixBurstOnIgnitedKill" }],
      },
      {
        id: "might_05b_sanctified_hearth",
        attributeId: AttributeId.Might,
        tier: 5,
        prereqs: ["might_04_press_the_burn"],
        exclusiveGroup: "t5_might",
        activationMode: ActivationMode.Attuned,
        tags: { attributeTag: AttributeId.Might },
        effects: [{ kind: "todo", action: "consecrateOnDashEnd" }],
      },
      {
        id: "might_06_ember_spread",
        attributeId: AttributeId.Might,
        tier: 6,
        prereqs: ["might_04_press_the_burn"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Hybrid,
        tags: { attributeTag: AttributeId.Might },
        effects: [{ kind: "todo", action: "igniteSplashOnDeath" }],
      },
      {
        id: "might_07_flames_of_hearth",
        attributeId: AttributeId.Might,
        tier: 7,
        prereqs: ["might_06_ember_spread"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Might },
        effects: [{ kind: "todo", action: "hearthStackDecayTuning" }],
      },
      {
        id: "might_08_ignite_mastery",
        attributeId: AttributeId.Might,
        tier: 8,
        prereqs: ["might_07_flames_of_hearth"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Might },
        effects: [{ kind: "todo", action: "ignitePoolCapIncrease" }],
      },
      {
        id: "might_10a_cinderstorm_moment",
        attributeId: AttributeId.Might,
        tier: 10,
        prereqs: ["might_08_ignite_mastery"],
        exclusiveGroup: "t10_might",
        activationMode: ActivationMode.Attuned,
        tags: { attributeTag: AttributeId.Might },
        effects: [{ kind: "todo", action: "cinderBurstOnEliteKill" }],
      },
      {
        id: "might_10b_phoenix_rebirth",
        attributeId: AttributeId.Might,
        tier: 10,
        prereqs: ["might_08_ignite_mastery"],
        exclusiveGroup: "t10_might",
        activationMode: ActivationMode.Attuned,
        tags: { attributeTag: AttributeId.Might },
        effects: [{ kind: "todo", action: "phoenixRebirthLowHpConsumeHearth" }],
      },
    ]),
  }),
  [AttributeId.Will]: Object.freeze({
    attributeId: AttributeId.Will,
    nodes: Object.freeze([
      {
        id: "will_01_soak",
        attributeId: AttributeId.Will,
        tier: 1,
        prereqs: [],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Will },
        effects: [{ kind: "todo", action: "applySoakedOnHit" }],
      },
      {
        id: "will_02_undertow_drag",
        attributeId: AttributeId.Will,
        tier: 2,
        prereqs: ["will_01_soak"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Will },
        effects: [{ kind: "todo", action: "soakedPullResistDown" }],
      },
      {
        id: "will_03_lunar_tide",
        attributeId: AttributeId.Will,
        tier: 3,
        prereqs: ["will_02_undertow_drag"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Hybrid,
        tags: { attributeTag: AttributeId.Will },
        effects: [{ kind: "todo", action: "soulOrbDriftTowardPlayer" }],
      },
      {
        id: "will_04_conductive_water",
        attributeId: AttributeId.Will,
        tier: 4,
        prereqs: ["will_03_lunar_tide"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Will },
        effects: [{ kind: "todo", action: "applyConductiveOnRepeatedHits" }],
      },
      {
        id: "will_05a_whirlpool_curse",
        attributeId: AttributeId.Will,
        tier: 5,
        prereqs: ["will_04_conductive_water"],
        exclusiveGroup: "t5_will",
        activationMode: ActivationMode.Attuned,
        tags: { attributeTag: AttributeId.Will },
        effects: [{ kind: "todo", action: "spawnWhirlpoolOnKill" }],
      },
      {
        id: "will_05b_abyssal_tentacle",
        attributeId: AttributeId.Will,
        tier: 5,
        prereqs: ["will_04_conductive_water"],
        exclusiveGroup: "t5_will",
        activationMode: ActivationMode.Attuned,
        tags: { attributeTag: AttributeId.Will },
        effects: [{ kind: "todo", action: "spawnTentacleSlamPeriodically" }],
      },
      {
        id: "will_06_high_tide_window",
        attributeId: AttributeId.Will,
        tier: 6,
        prereqs: ["will_04_conductive_water"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Hybrid,
        tags: { attributeTag: AttributeId.Will },
        effects: [{ kind: "todo", action: "controlDurationTuning" }],
      },
      {
        id: "will_07_tempest_conductor",
        attributeId: AttributeId.Will,
        tier: 7,
        prereqs: ["will_06_high_tide_window"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Will },
        effects: [{ kind: "todo", action: "conductiveArcControl" }],
      },
      {
        id: "will_08_moonbound_current",
        attributeId: AttributeId.Will,
        tier: 8,
        prereqs: ["will_07_tempest_conductor"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Will },
        effects: [{ kind: "todo", action: "soulPickupSoakBuff" }],
      },
      {
        id: "will_10a_maelstrom",
        attributeId: AttributeId.Will,
        tier: 10,
        prereqs: ["will_08_moonbound_current"],
        exclusiveGroup: "t10_will",
        activationMode: ActivationMode.Attuned,
        tags: { attributeTag: AttributeId.Will },
        effects: [{ kind: "todo", action: "upgradeMajorWhirlpoolSingle" }],
      },
      {
        id: "will_10b_call_of_the_deep",
        attributeId: AttributeId.Will,
        tier: 10,
        prereqs: ["will_08_moonbound_current"],
        exclusiveGroup: "t10_will",
        activationMode: ActivationMode.Attuned,
        tags: { attributeTag: AttributeId.Will },
        effects: [{ kind: "todo", action: "upgradeTentacleSignatureBehavior" }],
      },
    ]),
  }),
  [AttributeId.Alacrity]: Object.freeze({
    attributeId: AttributeId.Alacrity,
    nodes: Object.freeze([
      {
        id: "alac_01_windstep",
        attributeId: AttributeId.Alacrity,
        tier: 1,
        prereqs: [],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Alacrity },
        effects: [{ kind: "todo", action: "moveSpeedMultSmall" }],
      },
      {
        id: "alac_02_quickhands",
        attributeId: AttributeId.Alacrity,
        tier: 2,
        prereqs: ["alac_01_windstep"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Alacrity },
        effects: [{ kind: "todo", action: "attackSpeedSmall" }],
      },
      {
        id: "alac_03_gust_spacing",
        attributeId: AttributeId.Alacrity,
        tier: 3,
        prereqs: ["alac_02_quickhands"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Hybrid,
        tags: { attributeTag: AttributeId.Alacrity },
        effects: [{ kind: "todo", action: "gustOnDashEnd" }],
      },
      {
        id: "alac_04_guided_projectiles",
        attributeId: AttributeId.Alacrity,
        tier: 4,
        prereqs: ["alac_03_gust_spacing"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Alacrity },
        effects: [{ kind: "todo", action: "projectileGuidanceMild" }],
      },
      {
        id: "alac_05a_pinball_dash",
        attributeId: AttributeId.Alacrity,
        tier: 5,
        prereqs: ["alac_04_guided_projectiles"],
        exclusiveGroup: "t5_alac",
        activationMode: ActivationMode.Attuned,
        tags: { attributeTag: AttributeId.Alacrity },
        effects: [{ kind: "todo", action: "pinballDashChainTargets" }],
      },
      {
        id: "alac_05b_gale_dancer",
        attributeId: AttributeId.Alacrity,
        tier: 5,
        prereqs: ["alac_04_guided_projectiles"],
        exclusiveGroup: "t5_alac",
        activationMode: ActivationMode.Attuned,
        tags: { attributeTag: AttributeId.Alacrity },
        effects: [{ kind: "todo", action: "galeMomentumStacksOnDash" }],
      },
      {
        id: "alac_06_extra_charge",
        attributeId: AttributeId.Alacrity,
        tier: 6,
        prereqs: ["alac_04_guided_projectiles"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Hybrid,
        tags: { attributeTag: AttributeId.Alacrity },
        effects: [{ kind: "todo", action: "extraDashChargePlusRecharge" }],
      },
      {
        id: "alac_07_slipstream",
        attributeId: AttributeId.Alacrity,
        tier: 7,
        prereqs: ["alac_06_extra_charge"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Alacrity },
        effects: [{ kind: "todo", action: "slipstreamBuffWhileMoving" }],
      },
      {
        id: "alac_08_windguard",
        attributeId: AttributeId.Alacrity,
        tier: 8,
        prereqs: ["alac_07_slipstream"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Alacrity },
        effects: [{ kind: "todo", action: "damageReductionAfterDash" }],
      },
      {
        id: "alac_10a_cyclone_break",
        attributeId: AttributeId.Alacrity,
        tier: 10,
        prereqs: ["alac_08_windguard"],
        exclusiveGroup: "t10_alac",
        activationMode: ActivationMode.Attuned,
        tags: { attributeTag: AttributeId.Alacrity },
        effects: [{ kind: "todo", action: "disperseOnMajorGaleProc" }],
      },
      {
        id: "alac_10b_perfect_cadence",
        attributeId: AttributeId.Alacrity,
        tier: 10,
        prereqs: ["alac_08_windguard"],
        exclusiveGroup: "t10_alac",
        activationMode: ActivationMode.Attuned,
        tags: { attributeTag: AttributeId.Alacrity },
        effects: [{ kind: "todo", action: "firstHitAfterDashGuaranteedProc" }],
      },
    ]),
  }),
  [AttributeId.Constitution]: Object.freeze({
    attributeId: AttributeId.Constitution,
    nodes: Object.freeze([
      {
        id: "con_01_ward_seed",
        attributeId: AttributeId.Constitution,
        tier: 1,
        prereqs: [],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Constitution },
        effects: [{ kind: "todo", action: "enableWardResource" }],
      },
      {
        id: "con_02_stonehide",
        attributeId: AttributeId.Constitution,
        tier: 2,
        prereqs: ["con_01_ward_seed"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Constitution },
        effects: [{ kind: "todo", action: "damageTakenMultDownOrArmor" }],
      },
      {
        id: "con_03_thorn_marrow",
        attributeId: AttributeId.Constitution,
        tier: 3,
        prereqs: ["con_02_stonehide"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Hybrid,
        tags: { attributeTag: AttributeId.Constitution },
        effects: [{ kind: "todo", action: "thornsOnDamageTaken" }],
      },
      {
        id: "con_04_bone_plating",
        attributeId: AttributeId.Constitution,
        tier: 4,
        prereqs: ["con_03_thorn_marrow"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Constitution },
        effects: [{ kind: "todo", action: "boneShieldOnBigHit" }],
      },
      {
        id: "con_05a_wardweaver",
        attributeId: AttributeId.Constitution,
        tier: 5,
        prereqs: ["con_04_bone_plating"],
        exclusiveGroup: "t5_con",
        activationMode: ActivationMode.Attuned,
        tags: { attributeTag: AttributeId.Constitution },
        effects: [{ kind: "todo", action: "wardRegenRule" }],
      },
      {
        id: "con_05b_bone_mirror",
        attributeId: AttributeId.Constitution,
        tier: 5,
        prereqs: ["con_04_bone_plating"],
        exclusiveGroup: "t5_con",
        activationMode: ActivationMode.Attuned,
        tags: { attributeTag: AttributeId.Constitution },
        effects: [{ kind: "todo", action: "projectileReflectWhileBoneShield" }],
      },
      {
        id: "con_06_more_ward",
        attributeId: AttributeId.Constitution,
        tier: 6,
        prereqs: ["con_04_bone_plating"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Constitution },
        effects: [{ kind: "todo", action: "wardTuningDial" }],
      },
      {
        id: "con_07_splinterburst",
        attributeId: AttributeId.Constitution,
        tier: 7,
        prereqs: ["con_06_more_ward"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Hybrid,
        tags: { attributeTag: AttributeId.Constitution },
        effects: [{ kind: "todo", action: "splinterburstOnThorns" }],
      },
      {
        id: "con_08_granite_oath",
        attributeId: AttributeId.Constitution,
        tier: 8,
        prereqs: ["con_07_splinterburst"],
        exclusiveGroup: null,
        activationMode: ActivationMode.Always,
        tags: { attributeTag: AttributeId.Constitution },
        effects: [{ kind: "todo", action: "mitigationWhileWardHigh" }],
      },
      {
        id: "con_10a_fortress_protocol",
        attributeId: AttributeId.Constitution,
        tier: 10,
        prereqs: ["con_08_granite_oath"],
        exclusiveGroup: "t10_con",
        activationMode: ActivationMode.Attuned,
        tags: { attributeTag: AttributeId.Constitution },
        effects: [{ kind: "todo", action: "wardBreakRefillUnstoppable" }],
      },
      {
        id: "con_10b_break_upon_me",
        attributeId: AttributeId.Constitution,
        tier: 10,
        prereqs: ["con_08_granite_oath"],
        exclusiveGroup: "t10_con",
        activationMode: ActivationMode.Attuned,
        tags: { attributeTag: AttributeId.Constitution },
        effects: [{ kind: "todo", action: "thornsStrongerWhileWard" }],
      },
    ]),
  }),
});
